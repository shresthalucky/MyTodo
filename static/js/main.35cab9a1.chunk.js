(this.webpackJsonpmytodo=this.webpackJsonpmytodo||[]).push([[0],{35:function(e,t,a){e.exports=a(63)},40:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(30),s=a.n(r),i=(a(40),a(6)),l=a(7),c=a(8),d=a(9),u=a(5),m=a(1),p=a(31),g=a(19),h=a(32),f=a.n(h),v="".concat("https://todo-express-rest-api.herokuapp.com","/api"),b=f.a.create({baseURL:v,headers:{"Content-Type":"application/json"}});b.interceptors.request.use((function(e){var t=localStorage.getItem("token")||"";return t&&(e.headers.authorization=t),e}),(function(e){return Promise.reject(e)}));var E=b;var k=function(e){var t=e.type,a=e.name,n=e.value,r=e.changeHandler,s=e.placeholder;return o.a.createElement("input",{className:"input input--primary",type:t,name:a,value:n,onChange:r,placeholder:s})};var y=function(e){var t=e.type,a=e.disabled,n=e.clickHandler,r=e.className,s=e.icon,i=e.children;return o.a.createElement("button",{className:"btn btn--".concat(r||"primary"),type:t,onClick:n,disabled:a},s,i)},j=function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleInput=function(e){n.setState(Object(p.a)({},e.target.name,e.target.value))},n.toggleDisable=function(){n.setState({isDisable:!n.state.isDisable})},n.setErrorMessage=function(e){n.setState({errorMessage:e})},n.handleLogin=function(e){e.preventDefault(),n.setErrorMessage("Logging in..."),n.toggleDisable(),E.post("/users/login",{username:n.state.username,password:n.state.password}).then((function(e){n.props.tokenHandler(e.data)})).catch((function(e){n.setErrorMessage(e.response.data.message),n.toggleDisable()}))},n.handleRegister=function(e){n.setErrorMessage("Registering..."),n.toggleDisable(),E.post("/users/register",{username:n.state.username,password:n.state.password}).then((function(e){n.props.tokenHandler(e.data)})).catch((function(e){n.setErrorMessage(e.response.data.message),n.toggleDisable()}))},n.state={username:"",password:"",isDisable:!1,errorMessage:"\u200f\u200f\u200e \u200e"},n}return Object(l.a)(a,[{key:"render",value:function(){var e=(this.props.location.state||{from:{pathname:"/"}}).from;return this.props.token?o.a.createElement(m.a,{to:e}):o.a.createElement("div",{className:"outer-wrapper"},o.a.createElement("div",{className:"outer-wrapper__cell"},o.a.createElement("div",{className:"login-wrapper"},o.a.createElement("form",{onSubmit:this.handleLogin},o.a.createElement("div",{className:"login-wrapper__input"},o.a.createElement(k,{type:"text",changeHandler:this.handleInput,value:this.state.username,name:"username",placeholder:"username"})),o.a.createElement("div",{className:"login-wrapper__input"},o.a.createElement(k,{type:"password",changeHandler:this.handleInput,value:this.state.password,name:"password",placeholder:"password"})),o.a.createElement("div",{className:"errorMessage"},this.state.errorMessage),o.a.createElement("div",{className:"login-buttons"},o.a.createElement(y,{type:"submit",className:"purple",clickHandler:this.handleLogin,icon:o.a.createElement(g.b,null),disabled:this.state.isDisable},"Login"),o.a.createElement(y,{type:"button",className:"blue",clickHandler:this.handleRegister,icon:o.a.createElement(g.a,null),disabled:this.state.isDisable},"Register"))))))}}]),a}(o.a.Component),D=a(34);var L=function(e){return e.links.map((function(e){return o.a.createElement(u.b,{to:e.to,key:e.name},e.name)}))},O=a(14),H=a(10);var S=function(e){var t=e.detail,a=e.deleteHandler,r=e.updateHandler,s=e.editHandler,i=t.id,l=t.title,c=t.description,d=t.created,u=t.updated,m=t.status,p=Object(n.useState)(!1),g=Object(H.a)(p,2),h=g[0],f=g[1],v=Object(n.useState)(!1),b=Object(H.a)(v,2),k=b[0],j=b[1];return o.a.createElement("div",{className:"todo",onClick:function(){j(!k)}},o.a.createElement("div",{className:"todo__detail"},o.a.createElement("h2",null,l),o.a.createElement("p",null,c),o.a.createElement("div",{className:"todo-date"},o.a.createElement("span",{className:"todo-date__created"},"Created on ",new Date(1e3*d).toDateString()),d!==u&&o.a.createElement("span",{className:"todo-date__updated"},"Updated on ",new Date(1e3*u).toDateString()))),k&&o.a.createElement("div",{className:"todo__action"},o.a.createElement(y,{type:"button",className:"green",clickHandler:function(e){e.stopPropagation(),f(!0);var t={title:l,description:c,status:"active"===m?"done":"active"};E.put("/todos/".concat(i),t).then((function(e){r(i,e.data)})).catch((function(e){return console.log(e)})).finally((function(){f(!1)}))},disabled:h},"done"===m?"Undone":"Done"),o.a.createElement(y,{type:"button",className:"purple",clickHandler:function(e){e.stopPropagation(),s(t)},disabled:h},"Edit"),o.a.createElement(y,{type:"button",className:"blue",clickHandler:function(e){e.stopPropagation(),f(!0),E.delete("/todos/".concat(i)).then((function(){a(i)})).catch((function(e){return console.log(e)}))},disabled:h},"Delete")))};var w=function(e){var t=e.submitHandler,a=e.initialData,r=(e.loading,Object(n.useState)(a.title||"")),s=Object(H.a)(r,2),i=s[0],l=s[1],c=Object(n.useState)(a.description||""),d=Object(H.a)(c,2),u=d[0],m=d[1],p=function(e){"title"===e.target.name&&l(e.target.value),"description"===e.target.name&&m(e.target.value)};return o.a.createElement("div",null,o.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n=a.status||"active";t({title:i,description:u,status:n},a.id)}},o.a.createElement("div",null,o.a.createElement("input",{name:"title",placeholder:"Title",onChange:p,value:i})),o.a.createElement("div",null,o.a.createElement("textarea",{name:"description",placeholder:"Description",onChange:p,value:u})),o.a.createElement("div",null,o.a.createElement(y,{type:"reset",clickHandler:function(){l(""),m("")}},"Clear"),o.a.createElement(y,{type:"submit"},a.title?"Update":"Add"))))};var N=function(e){return function(t){var a=t.isLoading,n=t.error,r=Object(O.a)(t,["isLoading","error"]);return n?o.a.createElement("span",null,"Error Occured!"):a?o.a.createElement("div",null,"Loading..."):o.a.createElement(e,r)}}((function(e){var t=e.list,a=Object(O.a)(e,["list"]);return t.map((function(e){return o.a.createElement(S,Object.assign({detail:e,key:e.id},a))}))})),M=function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).handleForm=function(e,t){n.toggleFormLoading(),t?n.editTodo(e,t):n.addNewTodo(e)},n.addNewTodo=function(e){E.post("/todos",e).then((function(e){n.toggleModal(),n.setState({todoList:[e.data].concat(Object(D.a)(n.state.todoList))})})).catch((function(e){return console.log(e)})).finally((function(){return n.toggleFormLoading}))},n.editTodo=function(e,t){E.put("/todos/".concat(t),e).then((function(e){n.handleUpdate(t,e.data),n.toggleModal()})).catch((function(e){return console.log(e)})).finally((function(){return n.toggleFormLoading}))},n.toggleFormLoading=function(){n.setState({isPosting:!n.state.isPosting})},n.toggleModal=function(e){n.modalData=e||{},n.setState({showModal:!n.state.showModal})},n.handleDelete=function(e){n.setState({todoList:n.state.todoList.filter((function(t){return t.id!==e}))})},n.handleUpdate=function(e,t){n.setState({todoList:n.state.todoList.map((function(a){return a.id===e?t:a}))})},n.state={todoList:[],isLoading:!0,error:!1,isPosting:!1,showModal:!1},n.nav=[{name:"All",to:"/"},{name:"Active",to:"/active"},{name:"Done",to:"/done"}],n.modalData={},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.token&&E.get("/todos").then((function(t){e.setState({todoList:t.data,isLoading:!1})})).catch((function(){e.setState({error:!0})}))}},{key:"render",value:function(){if(!this.props.token)return o.a.createElement(m.a,{to:{pathname:"/login",state:{from:this.props.location}}});var e=this.state.todoList,t=this.props.location.pathname.split("/")[1];return"active"!==t&&"done"!==t||(e=this.state.todoList.filter((function(e){return e.status===t}))),o.a.createElement("div",null,this.state.showModal&&o.a.createElement(w,{submitHandler:this.handleForm,loading:this.state.isPosting,initialData:this.modalData}),o.a.createElement("div",null,"Home"),o.a.createElement(L,{links:this.nav}),o.a.createElement("div",null,o.a.createElement(y,{type:"button",clickHandler:this.toggleModal},"Add Todo")),o.a.createElement("div",null,o.a.createElement(y,{type:"button",clickHandler:this.props.logoutHandler},"Logout")),o.a.createElement(N,{error:this.state.error,isLoading:this.state.isLoading,deleteHandler:this.handleDelete,updateHandler:this.handleUpdate,editHandler:this.toggleModal,list:e}))}}]),a}(o.a.Component);var T=function(e){return o.a.createElement(u.a,{basename:"/MyTodo"},o.a.createElement(m.d,null,o.a.createElement(m.b,{exact:!0,path:"/login",render:function(t){return o.a.createElement(j,Object.assign({},t,e))}}),o.a.createElement(m.b,{path:"/",render:function(t){return o.a.createElement(M,Object.assign({},t,e))}})))},_=function(e){Object(d.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).setToken=function(e){var t=e.token,a=e.id,o=e.username;n.setState({token:t,id:a,username:o}),localStorage.setItem("token",t)},n.removeToken=function(){n.setState({token:"",id:"",username:""}),localStorage.removeItem("token")},n.state={token:"",id:"",username:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("token")||"";this.setState({token:t}),t&&E.get("/users").then((function(t){e.setToken(t.data)})).catch((function(){return e.removeToken}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"container"},o.a.createElement(T,{token:this.state.token,tokenHandler:this.setToken,logoutHandler:this.removeToken}))}}]),a}(o.a.Component);s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(_,null)),document.getElementById("root"))}},[[35,1,2]]]);
//# sourceMappingURL=main.35cab9a1.chunk.js.map